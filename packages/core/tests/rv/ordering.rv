# Ordering Test: JD1 Strategy
# Priority > Type > Affinity > Urgency
#
# Setup:
# 1. High Priority Topic (P=80) -> note-1
# 2. Medium Priority Topic (P=50) -> note-2
# 3. High Priority Cloze (P=90) -> note-3::c1
# 4. Low Priority Cloze (P=10) -> note-4::c1
#
# Scores:
# P90 Cloze (note-3::c1): 90*100 = 9000
# P80 Topic (note-1): 80*100 + 50 = 8050
# P50 Topic (note-2): 50*100 + 50 = 5050
# P10 Cloze (note-4::c1): 10*100 = 1000
#
# NOTE: Topics get +50 type weight.
# Note-3 (Topic P90) -> 9050
# Note-3::c1 (Cloze P90) -> 9000
# So Topic note-3 appears before its cloze.

session JD1
clock 2025-01-01

topic "Topic P80" --priority 80
topic "Topic P50" --priority 50

topic "Note for Cloze P90" --priority 90
cloze LAST 0 10

topic "Note for Cloze P10" --priority 10
cloze LAST 0 10

# 1. Note-3 (Topic P90) - Highest Score (9050)
inspect-next
expect session.nextItem note-3
grade note-3 3

# 2. Note-3::c1 (Cloze P90) - Score 9000 (New)
# Note: after grading topic, cloze might get affinity boost? 
# Context.linkedNoteIds includes note-3?
# JD1Strategy: if context.linkedNoteIds.has(item.noteId) -> +30.
# If last item was note-3, then lastNoteId=note-3.
# Links from note-3... none?
# But affinity is usually for "related" notes.
# Anyway, 9000 is still highest.
inspect-next
expect session.nextItem note-3::c1
grade note-3::c1 3

# 3. Note-1 (Topic P80) - Score 8050
inspect-next
expect session.nextItem note-1
grade note-1 3

# 4. Note-2 (Topic P50) - Score 5050
inspect-next
expect session.nextItem note-2
grade note-2 3

# 5. Note-4 (Topic P10) - Score 1050
inspect-next
expect session.nextItem note-4
grade note-4 3

# 6. Note-4::c1 (Cloze P10) - Score 1000
inspect-next
expect session.nextItem note-4::c1
